extends layout

block content
    .page-header
        .row
            .col-sm-6
                h1 VOTE!
                hr.highlight
    .clearfix
        if (!user)
            .row
                .col-sm-6
                    p Log in to view events and results
                    p
                        a.btn.btn-default(href='/login', role='button') Log In Â»
        else
            // ko ifnot: Editor
            
            // ko template: 'eventview'
            // /ko

            // /ko

            // ko if: Editor
            
            // ko template: 'eventedit'
            // /ko

            // /ko

    script#eventview(type="text/template")
        .row
            .col-sm-8
                .panel.panel-primary
                    .row
                        .col-sm-offset-1.col-sm-10
                            table.table.table-hover
                                thead
                                    tr
                                        th EventId
                                        th Phone Number
                                        th Live
                                        th Edit
                                        th Delete
                                tbody
                                    // ko foreach: Events
                                    tr
                                        td
                                            a(data-bind="attr: { href: '/event/' + _id + '/results' }")
                                                span(data-bind='text: Name')
                                        td(data-bind='text: PhoneNumber')
                                        td
                                            input(type='checkbox', data-bind='enable: false, checked: Enabled')
                                        td
                                            button.btn.btn-primary.btn-xs(data-placement="top", data-toggle="tooltip", data-original-title="Edit", data-bind="click: function() { $parent.Edit($data); }")
                                                i.glyphicon.glyphicon-pencil
                                        td
                                            button.btn.btn-danger.btn-xs(data-placement="top", data-toggle="tooltip", data-original-title="Delete", data-bind="click: function() { $parent.Delete($data); }")
                                                i.glyphicon.glyphicon-trash
                                    // /ko
                    .row
                        .col-sm-offset-11.col-sm-1
                            button.btn.btn-primary.btn-sm.pull-right(data-bind='click: AddNew')
                                i.glyphicon.glyphicon-plus
                                |  Add New Event

    script#eventedit(type="text/template")
        // ko with: Editor
        // ko with: Event
        .row
            .col-sm-6
                .panel.panel-primary
                    .row
                        h3.col-sm-offset-1.col-sm-4 Details
                    form.form-horizontal
                        .form-group
                            label.col-sm-3.control-label(for='inputVoteName') Name
                            .col-sm-8
                                input#inputVoteName.form-control(type='text', placeholder='Name', data-bind='value: Name')
                        .form-group
                            label.col-sm-3.control-label(for='inputPhoneNumber') Phone Number
                            .col-sm-8
                                input#inputPhoneNumber.form-control(type='tel', placeholder='PhoneNumber', data-bind='value: PhoneNumber')
                        .form-group
                            label.col-sm-3.control-label(for='chkEnabled') Enabled
                            .col-sm-1
                                input#chkEnabled.form-control.checkbox-inline(type='checkbox', data-bind='checked: Enabled')
            .col-sm-ofset-1.col-sm-6
                .panel.panel-primary
                    .row
                        .col-sm-offset-1.col-sm-10
                            h3 Artists
                            table.table
                                thead
                                    tr
                                        th Easel
                                        th Name
                                        th
                                        th Sort
                                tbody(data-bind="sortable: Contestants")
                                    tr
                                        td.col-sm-1
                                            .input-sm.text-success(data-bind="text: $index() + 1")
                                        td.col-sm-7
                                            input.input-sm.form-control(type='text', data-bind='value: Name', autofocus='true')
                                        td.col-sm-1
                                            button.btn.btn-sm.btn-danger(data-bind='click: () => { $parent.DeleteContestant($data); }')
                                                i.glyphicon.glyphicon-remove
                                        td.col-sm-1.drag-handle
                                            .input-sm
                                                i.glyphicon.glyphicon-menu-hamburger
                    .row
                        .col-sm-offset-11.col-sm-1
                            button.btn.btn-primary.btn-sm.pull-right(data-bind='click: AddContestant')
                                i.glyphicon.glyphicon-plus
                                |  Add New Artist

        hr.highlight
        .row
            .col-sm-ofset-1.col-sm-6
                h3 Rounds
                table.table
                    thead
                        th #
                        th Artists
                    tbody
                        // ko foreach: Rounds
                        tr
                            td.col-sm-1
                                strong(data-bind="text: RoundNumber")
                            td.col-sm-2
                                // ko if: AvailableContestants().length > 0
                                form
                                    // ko foreach: AvailableContestants
                                
                                    .checkbox
                                        label
                                            input(type="checkbox", data-bind="checked: $parent.Contestants, checkedValue: $data")
                                            // ko text: Name
                                            // /ko
                                    // /ko
                                // /ko
                                
                                // ko ifnot: AvailableContestants().length > 0
                                span Enter event contestants above
                                // /ko
                        // /ko
        .row
            .col-sm-offset-4.col-sm-2
                button.btn.btn-primary.btn-sm(data-bind='click: AddRound')
                    i.glyphicon.glyphicon-plus
                    |  Add New Round
        // /ko
        .row
            .col-sm-offset-10.col-sm-2
                button.btn.btn-default.pull-right(data-bind='click: Cancel') Cancel
                button.btn.btn-primary.pull-right(data-bind='click: Save') Save
        // /ko

block append scripts
    if(user)
        script(src='/js/home.js')
